# ðŸ“š OAPEN/DOAB ì˜¤í”ˆì•¡ì„¸ìŠ¤ ë„ì„œ í¬ë¡¤ëŸ¬

ì˜¤í”ˆì•¡ì„¸ìŠ¤ ë„ì„œ ì €ìž¥ì†Œ(OAPEN, DOAB ë“±)ì—ì„œ **ë¼ì´ì„ ìŠ¤ ê¸°ë°˜ í•„í„°ë§** í›„  
ì›ë¬¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ + ë©”íƒ€ë°ì´í„°(JSONL)ë¥¼ ìžë™ ìˆ˜ì§‘í•˜ëŠ” Node.js í¬ë¡¤ëŸ¬ìž…ë‹ˆë‹¤.

---

## ðŸ”§ ìš”êµ¬ì‚¬í•­

- **Node.js 18 ì´ìƒ** (fetch API ë‚´ìž¥ í•„ìš”)
- **Git** (ì†ŒìŠ¤ ê´€ë¦¬ìš©)
- **ì›ë³¸ CSV íŒŒì¼**: `repository-export.csv` (OAPEN/DOABì—ì„œ exportí•œ íŒŒì¼)

---

## ðŸš€ ë¹ ë¥¸ ì‹œìž‘ ê°€ì´ë“œ (ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œ ìž‘ì—… ì‹œ)

### 1ë‹¨ê³„ â€” ì €ìž¥ì†Œ í´ë¡ 

```bash
git clone https://github.com/happy-haru/crawl.git
cd crawl
```

### 2ë‹¨ê³„ â€” ì›ë³¸ CSV ë°°ì¹˜

ì›ë³¸ CSV íŒŒì¼(`repository-export.csv`)ì€ ìš©ëŸ‰ì´ ì»¤ì„œ Gitì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.  
ì•„ëž˜ ê²½ë¡œì— ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ ì£¼ì„¸ìš”:

```
crawl/
â””â”€ repository-export.csv   â† ì—¬ê¸°ì— ë°°ì¹˜
```

> ðŸ’¡ **íŒ**: Google Drive, OneDrive, USB ë“±ìœ¼ë¡œ ì˜®ê¸°ì„¸ìš”. (ì•½ 280MB)

### 3ë‹¨ê³„ â€” ë¼ì´ì„ ìŠ¤ í•„í„°ë§ ì‹¤í–‰

ì›ë³¸ CSVë¥¼ "í¬í•¨ ê°€ëŠ¥ / ì œì™¸ / ì• ë§¤" 3ê°œ ì¹´í…Œê³ ë¦¬ë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤:

```bash
npm run filter
```

ì¶œë ¥ íŒŒì¼:
- `repository-export-filtered.csv` â†’ í¬í•¨ ê°€ëŠ¥ + ì• ë§¤ (ë‹¤ìš´ë¡œë“œ ëŒ€ìƒ)
- `repository-export-excluded.csv` â†’ ì œì™¸ ëŒ€ìƒ

### 4ë‹¨ê³„ â€” í…ŒìŠ¤íŠ¸ ë‹¤ìš´ë¡œë“œ (ì„ íƒ)

ì‹¤ì œ ë‹¤ìš´ë¡œë“œ ì „ì— 5ê±´ì”© ì‹œë²” ìˆ˜ì§‘í•©ë‹ˆë‹¤:

```bash
npm test
```

### 5ë‹¨ê³„ â€” ì „ì²´ ë‹¤ìš´ë¡œë“œ ì‹¤í–‰

```bash
npm start
```

> â± ì•½ 52,000ê±´ Ã— í‰ê·  10ì´ˆ = **ì•½ 6ì¼** ì†Œìš” ì˜ˆìƒ  
> ðŸ” `Ctrl+C`ë¡œ ì¤‘ë‹¨í•´ë„ `_progress.json` ë•ë¶„ì— **ë‹¤ì‹œ ì‹¤í–‰ ì‹œ ì´ì–´ì„œ ì§„í–‰**ë¨

---

## ðŸ“ ì¶œë ¥ í´ë” êµ¬ì¡°

```
crawl_data/
â”œâ”€ allowed/                    # âœ… í¬í•¨ ê°€ëŠ¥ (CC BY ë“±)
â”‚  â”œâ”€ files/                   # ì›ë¬¸ íŒŒì¼ (PDF, EPUB, HTML ë“±)
â”‚  â”œâ”€ metadata/                # íŒŒì¼ë³„ ê°œë³„ ë©”íƒ€ JSON
â”‚  â””â”€ resources_metadata.jsonl # í†µí•© JSONL
â”œâ”€ ambiguous/                  # âš ï¸ ì• ë§¤í•œ ë¼ì´ì„ ìŠ¤
â”‚  â”œâ”€ files/
â”‚  â”œâ”€ metadata/
â”‚  â””â”€ resources_metadata.jsonl
â”œâ”€ failed/                     # âŒ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ ê±´
â”‚  â”œâ”€ *.json                   # ì‹¤íŒ¨ ê±´ë³„ ë©”íƒ€
â”‚  â””â”€ failed_downloads.jsonl   # ì‹¤íŒ¨ í†µí•© JSONL
â””â”€ _progress.json              # ì´ì–´ë°›ê¸° ìƒíƒœ íŒŒì¼
```

---

## ðŸ›¡ï¸ ì•ˆí‹°ë´‡ íƒì§€ íšŒí”¼ ì „ëžµ

| í•­ëª© | ì„¤ì • |
|------|------|
| ìš”ì²­ ê°„ ì§€ì—° | 6~15ì´ˆ ëžœë¤ |
| User-Agent | 6ì¢… ë¡œí…Œì´ì…˜ (Chrome/Firefox/Safari/Edge) |
| Referer | `google.com` ìŠ¤í‘¸í•‘ |
| ì‹¤íŒ¨ ìž¬ì‹œë„ | ìµœëŒ€ 3íšŒ, ì§€ìˆ˜ì  ë°±ì˜¤í”„ (10s â†’ 20s â†’ 40s + jitter) |
| 429/5xx ëŒ€ì‘ | ìžë™ ë°±ì˜¤í”„ í›„ ìž¬ì‹œë„ |
| ì´ì–´ë°›ê¸° | `_progress.json` ê¸°ë°˜ Resume |

---

## ðŸ“‹ ë©”íƒ€ë°ì´í„° í•„ë“œ ì„¤ëª…

ê° ê±´ì˜ JSONì—ëŠ” ë‹¤ìŒ í•„ë“œê°€ í¬í•¨ë©ë‹ˆë‹¤:

| í•„ë“œ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| `title` | ì œëª© | `"Human Cultures..."` |
| `source_site` | ì¶œì²˜ ë„ë©”ì¸ | `"directory.doabooks.org"` |
| `source_page_url` | ìƒì„¸íŽ˜ì´ì§€ URL | `https://...` |
| `download_url` | ì›ë¬¸ ë‹¤ìš´ë¡œë“œ URL | `https://...pdf` |
| `license_raw` | ë¼ì´ì„ ìŠ¤ ì›ë¬¸ | `"https://creativecommons.org/licenses/by/4.0/"` |
| `file_format` | íŒŒì¼ í¬ë§· | `"pdf"` |
| `download_status` | ì²˜ë¦¬ ê²°ê³¼ | `"success"` / `"failed"` |
| `download_status_reason` | ì‹¤íŒ¨ ì‚¬ìœ  | `"HTTP 404"` |
| `downloaded_at` | ë‹¤ìš´ë¡œë“œ ì‹œì  | `"2026-02-24T11:13:25Z"` |
| `authors` | ì €ìž | `"John Doe"` |
| `publisher` | ì¶œíŒì‚¬ | `"Springer"` |
| `doi` | DOI | `"10.1007/..."` |
| `isbn` | ISBN | `"978..."` |
| `language` | ì–¸ì–´ | `"English[eng]"` |

---

## ðŸ”„ ì‹¤íŒ¨í•œ ë‹¤ìš´ë¡œë“œ ìž¬ì‹œë„

ì‹¤íŒ¨ ê±´ë§Œ ë”°ë¡œ ìž¬ì‹œë„í•˜ë ¤ë©´ `failed/failed_downloads.jsonl`ì„ ì°¸ê³ í•˜ì—¬  
í•´ë‹¹ URLë“¤ì„ ìˆ˜ë™ìœ¼ë¡œ í™•ì¸í•˜ê±°ë‚˜ ë³„ë„ì˜ ìž¬ì‹œë„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.

---

## ðŸ“œ ìŠ¤í¬ë¦½íŠ¸ ëª©ë¡

| íŒŒì¼ | ì—­í•  |
|------|------|
| `filter_csv.js` | ì›ë³¸ CSV â†’ ë¼ì´ì„ ìŠ¤ ê¸°ì¤€ ë¶„ë¥˜ |
| `downloader.js` | í•„í„°ë§ ê²°ê³¼ ê¸°ë°˜ íŒŒì¼ ë‹¤ìš´ë¡œë“œ + ë©”íƒ€ ìˆ˜ì§‘ |
| `package.json` | npm ìŠ¤í¬ë¦½íŠ¸ ë‹¨ì¶•í‚¤ |

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

- **ì›ë³¸ CSVì™€ ë‹¤ìš´ë¡œë“œ ë°ì´í„°ëŠ” Gitì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤** (`.gitignore` ì²˜ë¦¬ë¨)
- Node.js 18 ë¯¸ë§Œì—ì„œëŠ” `fetch` APIê°€ ì—†ì–´ ì‹¤í–‰ ë¶ˆê°€í•©ë‹ˆë‹¤
- ìž¥ì‹œê°„ ì‹¤í–‰ ì‹œ í„°ë¯¸ë„ì´ ë‹«ížˆì§€ ì•Šë„ë¡ `tmux`, `screen`, ë˜ëŠ” `nohup`ì„ ì‚¬ìš©í•˜ì„¸ìš”:
  ```bash
  nohup node downloader.js > download.log 2>&1 &
  ```
